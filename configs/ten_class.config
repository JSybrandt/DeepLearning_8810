color_mode: RGB
target_size: {
  width:256
  height:256
}
class_mode: "categorical"

batch_size: 32
epochs: 200
steps_per_epoch: 7724  # Num training examples

# Total number of training examples seen:
# 64 * 200 * 7724 = 98,867,200

# Model has 7,563,706 free param
model: {

  # 256x256
  layers { convolutional {
    filters: 64
    kernel_size { width: 3 height : 3 }
    pool_size { width: 2 height: 2 }
  } }

  # 128x128x64
  layers { convolutional {
    filters: 32
    kernel_size { width: 3 height : 3 }
    pool_size { width: 2 height: 2 }
  } }

  # 64x64x32
  layers { convolutional {
    filters: 16
    kernel_size { width: 3 height : 3 }
    pool_size { width: 2 height: 2 }
  } }

  # 32x32x16
  layers { flatten {}}

  # 16384

  layers { dense { units: 512 }}
  layers { dense { units: 256 }}
  layers { dense { units: 128 }}
  layers { dense { units: 10 activation: "softmax" }}

  loss: "categorical_crossentropy"
  optimizer: "sgd"
  metrics: "acc"
}

# This system config is specific for a phase 18 node
system { gpus: 2 workers:-1 }
